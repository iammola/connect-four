function colors(e){colorsArray=e;for(let o=e.length-1;o>0;o--){const t=Math.floor(Math.random()*(o+1));[e[o],e[t]]=[e[t],e[o]]}e.forEach((e,o)=>{if(o<6){const t=document.createElement("div");t.classList.add("circle_color"),0==o&&t.classList.add("chosen"),t.dataset.id=o,t.style.backgroundColor=e,chooseColor.append(t),t.addEventListener("click",()=>{chooseColor.querySelector(".chosen").classList.remove("chosen"),t.classList.add("chosen")})}})}const socket=io();socket.emit(playerColors,""),socket.on(availableColors,e=>colors(e)),socket.on(playerConnect,e=>init(new Player(e.id,e.name,e.color,e.room))),socket.on(playerDisconnect,e=>playerAlert(e)),socket.on(playerPuckMoveOpponent,e=>showOpponentMove(e));const chooseColor=document.querySelector(".player_modal .choose_color"),setName=document.querySelector(".player_modal .name input"),startGame=document.querySelector(".player_modal button.start_game"),playerId=parseInt(localStorage.getItem(ID)),playerRoom=localStorage.getItem(gameCode);let colorsArray;startGame.parentElement.parentElement.classList.add("unset_player"),setName.value=localStorage.getItem(username)||"";class Player{constructor(e,o,t,s,r=!1,a=0){this.id=e,this.name=o,this.color=t,this.score=a,this.official=r,this.room=s,this.cells=[],this.chances=[],this.setDetails()}setDetails(e=!0,o=!0,t=!0){const s=document.querySelector(`.player.player_${this.id}`);e&&(s.querySelector(".name").innerText=this.name),e&&this.official&&(s.querySelector(".name").innerText+=" (ME)"),o&&(s.querySelector(".color").style.backgroundColor=this.color),t&&(s.querySelector(".score").innerText=this.score)}winner(){this.score+=1,this.setDetails(!1,!1),resetCase()}addSpot(e){if(this.cells.push(e),socket.emit(playerPuckMove,{id:this.id,cell:e,room:this.room}),this.cells.length>=minStreak){const e=playerPossibleWins(this.cells);this.chances=e.playerChances,e.isWon&&(this.winner(),alert("Game won by "+this.name))}}changeID(e){this.id=e,this.score=0,1==e&&(this.official=!0),this.setDetails()}resetPlayer(){this.cells=[],this.chances=[]}}2==playerId&&(socket.emit(playerGameJoin,new Player(playerId,"","",playerRoom,!1,"")),socket.emit(getPlayerOpponent,playerId)),startGame.addEventListener("click",()=>{colorsArray.splice(chooseColor.querySelector(".chosen").dataset.id,1);const e=getComputedStyle(chooseColor.querySelector(".chosen")).backgroundColor,o=""==setName.value?`User_${Math.floor(150*Math.random())}`:setName.value.toUpperCase(),t=new Player(playerId,o,e,playerRoom,!0);socket.emit(playerGameJoin,t),startGame.parentElement.parentElement.classList.remove("unset_player"),init(t),2==playerId&&socket.emit(getPlayerOpponent,1),""!=setName.value&&localStorage.setItem(username,o),localStorage.removeItem(ID),localStorage.removeItem(gameCode)});